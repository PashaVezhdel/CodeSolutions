import numpy as np
from scipy import stats

# Вихідні дані для варіанту 4
x1 = np.array([57.25, 57.38, 57.33, 57.42, 57.51, 57.29, 57.18, 57.29, 57.35, 57.46, 57.43, 57.12, 57.23, 57.35])
x2 = np.array([57.12, 57.25, 57.22, 57.17, 57.34, 56.99, 57.32, 57.14, 57.40, 57.08, 57.22, 57.29, 57.25, 57.45, 56.98])

# Кількість спостережень
n1 = len(x1)
n2 = len(x2)

# 1. Перевірка гіпотези про рівність центрів розподілу
print("1. Перевірка гіпотези про рівність центрів розподілу (t-критерій Стьюдента)")

# Обчислення середніх вибіркових
x1_mean = np.mean(x1)
x2_mean = np.mean(x2)

print(f"\nСереднє значення першого ряду: {x1_mean:.4f} ")
print(f"Середнє значення другого ряду: {x2_mean:.4f} ")

# Обчислення різниці між середніми
delta = x1_mean - x2_mean
print(f"\nРізниця між середніми: {delta:.4f} ")

# Обчислення вибіркових дисперсій (незміщена оцінка)
var1 = np.var(x1, ddof=1)
var2 = np.var(x2, ddof=1)

print(f"\nВибіркова дисперсія першого ряду: {var1:.4f} ")
print(f"Вибіркова дисперсія другого ряду: {var2:.4f} ")

# Обчислення загальної середньої квадратичної похибки
M = np.sqrt(var1/n1 + var2/n2)
print(f"\nЗагальна середня квадратична похибка: {M:.4f} ")

# Обчислення статистики Z (для малих вибірок n1 < 30 і n2 < 30)
k1 = n1 - 1
k2 = n2 - 1
numerator = delta * np.sqrt(n1 * n2 * (n1 + n2 - 2))
denominator = np.sqrt((k1 * var1 + k2 * var2) * (n1 + n2))
Z = numerator / denominator

print(f"\nСтатистика Z: {Z:.4f}")

# Визначення критичного значення (t-розподіл Стьюдента)
p = 0.90  # Довірча ймовірність
q = 1 - p
df = n1 + n2 - 2  # Ступені свободи
t_critical = stats.t.ppf(1 - q/2, df)

print(f"\nКритичне значення t-критерію: {t_critical:.4f}")

# Перевірка гіпотези
if abs(Z) <= t_critical:
    print("\nВисновок: Нульова гіпотеза H0 приймається. Систематичний вплив відсутній.")
else:
    print("\nВисновок: Нульова гіпотеза H0 відхиляється. Присутній систематичний вплив.")

# 2. Перевірка гіпотези про рівноточність рядів (F-критерій)
print("\n2. Перевірка гіпотези про рівноточність рядів (F-критерій)")

# Обчислення статистики F
if var1 > var2:
    F = var1 / var2
    df1 = n1 - 1
    df2 = n2 - 1
else:
    F = var2 / var1
    df1 = n2 - 1
    df2 = n1 - 1

print(f"\nСтатистика F: {F:.4f}")

# Визначення критичного значення (F-розподіл Фішера)
p = 0.95  # Довірча ймовірність
q = 1 - p
F_critical = stats.f.ppf(1 - q/2, df1, df2)

print(f"Критичне значення F-критерію: {F_critical:.4f}")

# Перевірка гіпотези
if F <= F_critical:
    print("\nВисновок: Нульова гіпотеза H0 приймається. Ряди вимірів рівноточні.")
else:
    print("\nВисновок: Нульова гіпотеза H0 відхиляється. Ряди вимірів нерівноточні.")